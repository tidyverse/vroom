# .work.toml - Work agent configuration
# See: https://github.com/jimhester/dotfiles/blob/main/genai/work

# Additional instructions appended to the worker prompt.
# Customize for your project's specific conventions.
worker_guidelines = """
## Project-Specific Guidelines

### Performance Changes
When making performance improvements, do NOT rely on intuition. You must:
1. Use profiling to identify hot spots in the current code
2. Generate hypotheses about what could improve performance
3. Test those hypotheses with benchmarks before and after
4. Include benchmark results in the PR description

Run benchmarks with: `./build/libvroom_benchmark`
"""

# Custom review guidelines for self-review.
# If empty, uses sensible defaults.
review_guidelines = """
# libvroom Code Review

High-performance SIMD CSV parser. Two-pass speculative parsing, multi-threaded.

## Two-Phase Review Process

### Phase 1: Investigation (Find ALL potential issues)
1. **Read CLAUDE.md** for project requirements
2. **Examine full files** (not just diff context) - use Read tool
3. **Search for related code** - use Grep for patterns affected by changes
4. **Check git history** - use git blame/log to understand intent

Bug categories to check:
- **Arithmetic**: overflow in size calculations, division by zero, off-by-one at boundaries
- **Memory**: buffer overflows in SIMD (64-byte chunks), null pointers, resource leaks
- **CSV-specific**: quote handling, field boundaries at SIMD chunk edges, quote parity
- **Concurrency**: race conditions, thread safety of shared state
- **Technical claims**: use WebSearch to verify Unicode ranges, spec compliance, etc.

### Phase 2: Verification (Filter false positives)
For each issue, re-read the code independently and score confidence 0-100:
- **0-30**: False positive (provably correct) → discard
- **40-60**: Uncertain → report, let human decide
- **70-100**: Likely/definitely a bug → report

Report issues scoring 40+. Don't dismiss issues just because tests pass or comments say it's intentional.

## Cross-API Consistency
Changes to enums, options, or behavior may need updates to:
- C API (`src/libvroom_c.cpp`)
- Python bindings (`python/src/bindings.cpp`)
- CLI (`src/cli.cpp`)

Search for switch statements and duplicate implementations.

## Ignore
- Style/formatting (clang-format handles this)
- Pre-existing issues not introduced by this commit
- Nitpicks a senior engineer wouldn't flag

## Output
**SEVERITY - Brief description**
File: path:line
Explanation and suggested fix.

Severities: HIGH (will cause bugs), MEDIUM (potential issue), LOW (minor)
"""

# Review strictness: "strict", "normal", or "lenient"
# - strict: Flag anything that could potentially be an issue
# - normal: Balanced (default)
# - lenient: Only flag clear, obvious bugs
review_strictness = "normal"

# Whether to require review before merge (in addition to before PR)
require_pre_merge_review = true
